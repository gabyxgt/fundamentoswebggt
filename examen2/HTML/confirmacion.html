<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ConfirmaciÃ³n de Compra - PÃ©talo Vivo</title>
    <link rel="icon" type="image/jpeg" href="../IMG/favicon.jpg">
    <link rel="stylesheet" href="../CSS/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script src="../JS/emailjs-init.js"></script>
</head>
<body>
    <div class="site-wrapper">
    <header class="header">
        <div class="container">
            <div class="logo">
                <a href="index.html">
                    <img src="../IMG/LOGO1.png" alt="PÃ©talo Vivo">
                </a>
            </div>
            <nav class="nav">
                <ul>
                    <li><a href="index.html">Inicio</a></li>
                    <li><a href="nosotros.html">Nosotros</a></li>
                    <li><a href="productos.html">Productos</a></li>
                    <li><a href="servicios.html">Servicios</a></li>
                    <li><a href="blog.html">Blog</a></li>
                    <li><a href="galeria.html">GalerÃ­a</a></li>
                    <li><a href="contacto.html">Contacto</a></li>
                    <li><a href="carrito.html">ðŸ›’ <span id="cart-count">0</span></a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <section class="hero-section">
            <div class="container">
                <h1>Â¡Compra realizada con Ã©xito!</h1>
                <p>Gracias por confiar en PÃ©talo Vivo</p>
            </div>
        </section>

        <section class="purchase-summary">
            <div class="container">
                <div class="summary-card">
                    <h2>Detalles de tu Compra</h2>
                    <div class="purchase-items">
                        <h3>Productos Comprados</h3>
                        <div id="purchased-items"></div>
                    </div>
                    <div class="purchase-info">
                        <p><strong>Cliente:</strong> <span id="customer-name-display"></span></p>
                        <p><strong>NÃºmero de Orden:</strong> <span id="order-number"></span></p>
                        <p><strong>Total:</strong> <span id="total-display"></span></p>
                        <p><strong>Fecha:</strong> <span id="purchase-date"></span></p>
                    </div>
                    <button class="btn-primary" onclick="showSurvey()">Completar encuesta y obtener 10% de descuento</button>
                </div>
            </div>
        </section>

        <div id="encuesta-container" style="display: none;">
            <section class="survey-section">
                <div class="container">
                    <div class="survey-container">
                        <div class="survey-intro">
                            <h2>Â¡Queremos conocer tu experiencia!</h2>
                            <p>En PÃ©talo Vivo nos esforzamos constantemente por brindar el mejor servicio y productos de calidad. Tu feedback nos ayuda a seguir creciendo y mejorando.</p>
                            <p><strong>Tiempo estimado:</strong> 3-5 minutos</p>
                        </div>

                        <form id="survey-form" class="survey-form">
                            <div class="form-section">
                                <h3>InformaciÃ³n Personal</h3>
                                
                                <div class="form-group">
                                    <label for="name">Nombre</label>
                                    <input type="text" id="name" name="name">
                                </div>

                                <div class="form-group">
                                    <label for="email">Correo</label>
                                    <input type="email" id="email" name="email">
                                </div>
                            </div>

                            <div class="form-section">
                                <h3>EvaluaciÃ³n</h3>
                                
                                <div class="form-group">
                                    <label>Â¿CÃ³mo calificarÃ­as nuestro servicio?</label>
                                    <div class="rating-group">
                                        <label><input type="radio" name="service_rating" value="5" required> 5 - Excelente</label>
                                        <label><input type="radio" name="service_rating" value="4"> 4 - Muy bueno</label>
                                        <label><input type="radio" name="service_rating" value="3"> 3 - Bueno</label>
                                        <label><input type="radio" name="service_rating" value="2"> 2 - Regular</label>
                                        <label><input type="radio" name="service_rating" value="1"> 1 - Malo</label>
                                    </div>
                                </div>
                            </div>

                            <div class="form-section">
                                <h3>Productos</h3>
                                
                                <div class="form-group">
                                    <label>Â¿QuÃ© productos compraste?</label>
                                    <div class="checkbox-group">
                                        <label><input type="checkbox" name="products[]" value="plantas"> Plantas</label>
                                        <label><input type="checkbox" name="products[]" value="macetas"> Macetas</label>
                                        <label><input type="checkbox" name="products[]" value="fertilizantes"> Fertilizantes</label>
                                        <label><input type="checkbox" name="products[]" value="herramientas"> Herramientas</label>
                                        <label><input type="checkbox" name="products[]" value="servicios"> Servicios de diseÃ±o</label>
                                    </div>
                                </div>
                            </div>

                            <div class="form-section">
                                <h3>RecomendaciÃ³n</h3>
                                
                                <div class="form-group">
                                    <label>Â¿RecomendarÃ­as PÃ©talo Vivo?</label>
                                    <div class="rating-group">
                                        <label><input type="radio" name="recommend" value="si" required> SÃ­</label>
                                        <label><input type="radio" name="recommend" value="no"> No</label>
                                    </div>
                                </div>
                            </div>

                            <div class="form-section">
                                <h3>Comentarios</h3>
                                
                                <div class="form-group">
                                    <label for="comments">Comentario general</label>
                                    <textarea id="comments" name="comments" rows="4" placeholder="Comparte tu experiencia con nosotros..."></textarea>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="submit" class="btn-primary">Enviar Encuesta</button>
                            </div>
                        </form>
                    </div>
                </div>
            </section>
        </div>

        <div id="thank-you-section" style="display: none;">
            <section class="thank-you-section">
                <div class="container">
                    <div class="thank-you-content survey-thank-you-card">
                        <h2>Â¡Muchas Gracias!</h2>
                        <p>Tu opiniÃ³n es muy valiosa para nosotros. Hemos recibido tus respuestas y las utilizaremos para seguir mejorando nuestros productos y servicios.</p>
                        <p><strong>CÃ³digo de descuento: CLIENTE-PETALO</strong></p>
                        <a href="index.html" class="btn-primary">Volver al Inicio</a>
                    </div>
                </div>
            </section>
        </div>

    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>PÃ©talo Vivo</h3>
                    <p>Tu vivero de confianza en Costa Rica</p>
                </div>
                <div class="footer-section">
                    <h3>Contacto</h3>
                    <p><img src="../ICONS/pin.png" alt="UbicaciÃ³n" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> San JosÃ©, Costa Rica</p>
                    <p><img src="../ICONS/phone.png" alt="TelÃ©fono" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> +506 8338-8242</p>
                    <p><img src="../ICONS/email.png" alt="Email" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 5px;"> info@petalovivo.cr</p>
                </div>
                <div class="footer-section">
                    <h3>SuscrÃ­bete</h3>
                    <form id="newsletter-form" class="newsletter-form">
                        <input type="email" id="newsletter-email" placeholder="Tu email" required>
                        <button type="submit">Suscribir</button>
                    </form>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 PÃ©talo Vivo. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <script src="../JS/script.js"></script>
    <script>

        
        document.addEventListener('DOMContentLoaded', function() {
            const customerName = localStorage.getItem('customer_name') || 'Cliente';
            const total = localStorage.getItem('purchase_total') || '0';
            const orderNumber = 'PV-' + Math.floor(Math.random() * 900000 + 100000);
            const purchasedCart = JSON.parse(localStorage.getItem('resumen_carrito')) || [];
            
            document.getElementById('customer-name-display').textContent = customerName;
            document.getElementById('order-number').textContent = orderNumber;
            document.getElementById('total-display').textContent = 'â‚¡' + parseInt(total).toLocaleString();
            document.getElementById('purchase-date').textContent = new Date().toLocaleDateString();
            
            const purchasedItemsContainer = document.getElementById('purchased-items');
            if (purchasedCart.length > 0) {
                purchasedCart.forEach(item => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'purchased-item';
                    itemDiv.innerHTML = `
                        <img src="../IMG/${item.id}.png" alt="${item.name}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 5px;">
                        <div class="item-details">
                            <h4>${item.name}</h4>
                            <p>Cantidad: ${item.quantity} | Precio: â‚¡${item.price.toLocaleString()}</p>
                        </div>
                    `;
                    purchasedItemsContainer.appendChild(itemDiv);
                });
            }
            
            // Clear localStorage
            localStorage.removeItem('cart');
            localStorage.removeItem('resumen_carrito');
            localStorage.removeItem('resumen_total');
            localStorage.removeItem('resumen_envio');
            localStorage.removeItem('resumen_pago');
        });
        
        function showSurvey() {
            document.getElementById('encuesta-container').style.display = 'block';
            document.getElementById('encuesta-container').scrollIntoView({ behavior: 'smooth' });
        }
        
        document.getElementById('survey-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const serviceRating = document.querySelector('input[name="service_rating"]:checked')?.value || "";
            const products = Array.from(document.querySelectorAll('input[name="products[]"]:checked')).map(cb => cb.value).join(', ');
            const recommend = document.querySelector('input[name="recommend"]:checked')?.value || "";
            const comments = document.getElementById('comments').value;
            
            emailjs.send('service_wkc64y3', 'template_geaw92e', {
                name,
                email,
                service_rating: serviceRating,
                products,
                recommend,
                comments,
                phone: "",
                message: ""
            }).then(() => {
                document.getElementById('encuesta-container').style.display = 'none';
                document.getElementById('thank-you-section').style.display = 'block';
                document.getElementById('thank-you-section').scrollIntoView({ behavior: 'smooth' });
            }).catch((error) => {
                console.error('Error al enviar encuesta:', error);
                alert('Error al enviar encuesta. Intenta nuevamente.');
            });
        });
    </script>
    </div>
</body>
</html>